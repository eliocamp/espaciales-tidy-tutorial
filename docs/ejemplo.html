<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Relación entre presión a nivel del mar y ENSO</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Datos espaciales a lo tidy</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="preparacion.html">Preparación</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Materiales
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_intro.html">Introducción</a>
    </li>
    <li>
      <a href="02_lectura.html">Lectura</a>
    </li>
    <li>
      <a href="03_graficado.html">Graficado</a>
    </li>
    <li>
      <a href="04_calculos.html">Cómputos</a>
    </li>
    <li>
      <a href="guia-practica.html">Guía práctica</a>
    </li>
  </ul>
</li>
<li>
  <a href="ejemplo.html">Relación ENSO - Presión a nivel del mar</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/eliocamp/espaciales-tidy-tutorial/">Repositorio</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Relación entre presión a nivel del mar y ENSO</h1>

</div>


<pre class="r"><code># Cargo los paquetes necesarios
library(magrittr)
library(ggplot2)
library(dplyr)
library(data.table)
library(metR)</code></pre>
<p>Primero hay que leer los datos de temperatura del mar (SST) y de presión al nivel del mar (MSL).</p>
<pre class="r"><code>datos &lt;- ReadNetCDF(&quot;datos/temperatura_mar.nc&quot;, vars = c(&quot;sst&quot;, presion = &quot;msl&quot;))</code></pre>
<p>Como ayuda, también</p>
<pre class="r"><code>mapa &lt;- function(fill = &quot;white&quot;, colour = NA) {
  geom_polygon(data = map_data(&quot;world2&quot;), aes(long, lat, group = group), 
               fill = fill, colour = colour, inherit.aes = FALSE, size = 0.2)
}</code></pre>
<p>La principal variación de SST y de la presión suele ser el ciclo anual, que es predecible y no es interesante. Entonces, lo primero que hacemos es crear dos variables nuevas, <code>sst_a</code> y <code>presion_a</code> con las anomalías de temperatura y presión con respecto al ciclo anual. Esto es, el valor de cada variable menos el valor medio para cada mes y cada punto de grilla.</p>
<div id="section" class="section level3 tabset unlisted unnumbered">
<h3 class="tabset unlisted unnumbered"></h3>
<div id="data.table" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>datos[, `:=`(sst_a = sst - mean(sst), 
             presion_a = presion - mean(presion)),
      by = .(longitude, latitude, month(time))]</code></pre>
</div>
<div id="dplyr" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>datos &lt;- datos %&gt;% 
  group_by(longitude, latitude, mes = month(time)) %&gt;% 
  mutate(sst_a = sst - mean(sst), 
         presion_a = presion - mean(presion)) %&gt;% 
  ungroup() %&gt;% 
  select(-mes)</code></pre>
</div>
</div>
<div id="section-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered"></h3>
<p>El Niño, o ENSO por El Niño Southern Oscillation, es una de los principales modos de variabilidad del océano. Se trata de variaciones de baja frecuencia en la temperatura de la superficie del mar en el Pacífico Ecuatorial. Durante los eventos positivos (El Niño) la temperatura de la superficie del mar en el la región oriental del Pacífico ecuatorial es más alta de lo normal, y en los eventos negativos (La Niña), la temperatura es más fría de lo normal. Esta oscilación tiene impactos globales, afectando la temperatura y la precipitación de regiones muy alejadas, algo conocido como teleconexiones.</p>
<p>Una de las formas más comunes de medir el ENSO es con el índice oceánico, que es la anomalía media estandarizada en una caja entre 170ºE y 120ºE y 5ºS y 5ºN, que se muestra en la siguiente figura.</p>
<pre class="r"><code>datos %&gt;% 
  filter(time == unique(time)[225]) %&gt;% 
  ggplot(aes(longitude, latitude)) +
  geom_contour_fill(aes(z = sst_a), na.fill = TRUE) +
  mapa() +
  annotate(&quot;rect&quot;, xmax = 240, xmin = 190, ymin = -5, ymax = 5, fill = NA, color = &quot;black&quot;) +
  scale_fill_divergent()</code></pre>
<p><img src="ejemplo_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Entonces, antes que nada calculamos el índice de El Niño oceánico (ONI por la siglas de Oceanic Niño Index).</p>
</div>
<div id="section-2" class="section level3 tabset unlisted unnumbered">
<h3 class="tabset unlisted unnumbered"></h3>
<div id="data.table-1" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>enso &lt;- datos %&gt;% 
  .[abs(latitude) &lt; 5 &amp; ConvertLongitude(longitude) %between% c(-170, -120)] %&gt;% 
  .[, .(oni = mean(sst_a)), by = time] %&gt;% 
  .[, oni := oni/sd(oni)]</code></pre>
</div>
<div id="dplyr-1" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>enso &lt;- datos %&gt;% 
  filter(abs(latitude) &lt; 5 &amp; between(ConvertLongitude(longitude), -170, -120)) %&gt;% 
  group_by(time) %&gt;% 
  summarise(oni = mean(sst_a)) %&gt;% 
  ungroup() %&gt;% 
  mutate(oni = oni/sd(oni))</code></pre>
</div>
</div>
<div id="section-3" class="section level3 tabset unlisted unnumbered">
<h3 class="tabset unlisted unnumbered"></h3>
<p>(Técnicamente el ONI tiene también un promedio móvil de 3 meses, pero no hace tanta diferencia.)</p>
<p>¿Cómo evolucionó este índice a lo largo del tiempo? Podemos hacer un gráfico con el índice, marcando los valores de <span class="math inline">\(\pm0.5\)</span>, que definen los eventos Niño y Niña.</p>
<pre class="r"><code>ggplot(enso, aes(time, oni)) +
  geom_line() +
  geom_hline(yintercept = c(-0.5, 0.5), color = &quot;gray50&quot;) + 
  annotate(&quot;label&quot;, y = c(0.5, -0.5), x = lubridate::as_datetime(&quot;1979-01-01&quot;),
           label = c(&quot;NIÑO&quot;, &quot;NIÑA&quot;), vjust = c(-0.2, 1.2), 
           label.size = grid::unit(0,&quot;lines&quot;), color = &quot;gray50&quot;) +
  scale_x_datetime(name = NULL) +
  scale_y_continuous(name = NULL) +
  labs(title = &quot;Índice ENSO34&quot;, 
       caption = &quot;Fuente: ERA5 (1979–2020)&quot;) +
  theme_minimal()</code></pre>
<p><img src="ejemplo_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Se ven claramente algunos eventos niño particularmente fuertes, como el de 1983, 1998 o 2015, así como algunos eventos Niña también intensos, como en 1989.</p>
<p>Ahora podemos calcular los campos de regresión entre este índice y otras variables, presión a nivel del mar en este caso. Para eso hay que primero unir la tabla <code>enso</code> a los datos y luego calcular la regresión para cada punto de grilla.</p>
</div>
<div id="section-4" class="section level3 tabset unlisted unnumbered">
<h3 class="tabset unlisted unnumbered"></h3>
<div id="data.table-2" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>enso_regresion &lt;- datos %&gt;% 
  .[enso, on = &quot;time&quot;] %&gt;% 
  .[, FitLm(presion_a, oni), by = .(longitude, latitude)] %&gt;% 
  .[term != &quot;(Intercept)&quot;] </code></pre>
</div>
<div id="dplyr-2" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>enso_regresion &lt;- sst %&gt;% 
  right_join(enso, by = &quot;time&quot;) %&gt;% 
  group_by(latitude, longitude) %&gt;% 
  summarise(as.data.frame(FitLm(presion_a, oni))) %&gt;% 
  ungroup() %&gt;% 
  filter(term != &quot;(Intercept)&quot;) </code></pre>
</div>
</div>
<div id="section-5" class="section level3 tabset unlisted unnumbered">
<h3 class="tabset unlisted unnumbered"></h3>
<p>Y ahora que tenemos esto, podemos graficarlo.</p>
<pre class="r"><code>enso_regresion %&gt;% 
  ggplot(aes(longitude, latitude)) +
  geom_contour_fill(aes(z = estimate, fill = ..level..), na.fill = 0, 
                    breaks = AnchorBreaks(binwidth = 25, exclude = 0)) +
  geom_contour_tanaka(aes(z = estimate), na.fill = 0, 
                      breaks = AnchorBreaks(binwidth = 25, exclude = 0)) +
  mapa(fill = NA, colour = &quot;black&quot;)  +
  annotate(&quot;rect&quot;, xmax = 240, xmin = 190, ymin = -5, ymax = 5, 
           fill = NA, color = &quot;black&quot;) +
  scale_fill_divergent_discretised(name = &quot;hPa&quot;) +
  scale_x_longitude() +
  scale_y_latitude() +
  coord_quickmap() +
  theme_minimal() +
  labs(title = &quot;Regresíon presión a nivel del mar con ENSO&quot;, 
       caption = &quot;Fuente: ERA5 (1979–2020)&quot;)</code></pre>
<p><img src="ejemplo_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>En esta figura podemos ver las teleconexiones en acción. Los valores máximos de regresión entre la temperatura del mar y la presión al nivel del mar se da en la costa de la Antártica (el mar de Amundsen) e el hemisferio sur y en la región de las Aleutianas en el hemisferio norte.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiUmVsYWNpw7NuIGVudHJlIHByZXNpw7NuIGEgbml2ZWwgZGVsIG1hciB5IEVOU08iCm91dHB1dDogCiAgaHRtbF9kb2N1bWVudDoKICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKICAgIHRvYzogZmFsc2UKLS0tCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGNhY2hlID0gVFJVRSwKICBlY2hvID0gVFJVRSwKICBtZXNzYWdlID0gRkFMU0UsCiAgd2FybmluZyA9IEZBTFNFCikKYGBgCgoKCgoKYGBge3J9CiMgQ2FyZ28gbG9zIHBhcXVldGVzIG5lY2VzYXJpb3MKbGlicmFyeShtYWdyaXR0cikKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KGRwbHlyKQpsaWJyYXJ5KGRhdGEudGFibGUpCmxpYnJhcnkobWV0UikKYGBgCgpQcmltZXJvIGhheSBxdWUgbGVlciBsb3MgZGF0b3MgZGUgdGVtcGVyYXR1cmEgZGVsIG1hciAoU1NUKSB5IGRlIHByZXNpw7NuIGFsIG5pdmVsIGRlbCBtYXIgKE1TTCkuIAoKYGBge3J9CmRhdG9zIDwtIFJlYWROZXRDREYoImRhdG9zL3RlbXBlcmF0dXJhX21hci5uYyIsIHZhcnMgPSBjKCJzc3QiLCBwcmVzaW9uID0gIm1zbCIpKQpgYGAKCkNvbW8gYXl1ZGEsIHRhbWJpw6luIAoKYGBge3J9Cm1hcGEgPC0gZnVuY3Rpb24oZmlsbCA9ICJ3aGl0ZSIsIGNvbG91ciA9IE5BKSB7CiAgZ2VvbV9wb2x5Z29uKGRhdGEgPSBtYXBfZGF0YSgid29ybGQyIiksIGFlcyhsb25nLCBsYXQsIGdyb3VwID0gZ3JvdXApLCAKICAgICAgICAgICAgICAgZmlsbCA9IGZpbGwsIGNvbG91ciA9IGNvbG91ciwgaW5oZXJpdC5hZXMgPSBGQUxTRSwgc2l6ZSA9IDAuMikKfQpgYGAKCkxhIHByaW5jaXBhbCB2YXJpYWNpw7NuIGRlIFNTVCB5IGRlIGxhIHByZXNpw7NuIHN1ZWxlIHNlciBlbCBjaWNsbyBhbnVhbCwgcXVlIGVzIHByZWRlY2libGUgeSBubyBlcyBpbnRlcmVzYW50ZS4KRW50b25jZXMsIGxvIHByaW1lcm8gcXVlIGhhY2Vtb3MgZXMgY3JlYXIgZG9zIHZhcmlhYmxlcyBudWV2YXMsIGBzc3RfYWAgeSBgcHJlc2lvbl9hYCBjb24gbGFzIGFub21hbMOtYXMgZGUgdGVtcGVyYXR1cmEgeSBwcmVzacOzbiBjb24gcmVzcGVjdG8gYWwgY2ljbG8gYW51YWwuIApFc3RvIGVzLCBlbCB2YWxvciBkZSBjYWRhIHZhcmlhYmxlIG1lbm9zIGVsIHZhbG9yIG1lZGlvIHBhcmEgY2FkYSBtZXMgeSBjYWRhIHB1bnRvIGRlIGdyaWxsYS4gCgojIyMgey50YWJzZXQgLnVubGlzdGVkIC51bm51bWJlcmVkfQoKIyMjIyBkYXRhLnRhYmxlCgpgYGB7cn0KZGF0b3NbLCBgOj1gKHNzdF9hID0gc3N0IC0gbWVhbihzc3QpLCAKICAgICAgICAgICAgIHByZXNpb25fYSA9IHByZXNpb24gLSBtZWFuKHByZXNpb24pKSwKICAgICAgYnkgPSAuKGxvbmdpdHVkZSwgbGF0aXR1ZGUsIG1vbnRoKHRpbWUpKV0KYGBgCgojIyMjIGRwbHlyCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpkYXRvcyA8LSBkYXRvcyAlPiUgCiAgZ3JvdXBfYnkobG9uZ2l0dWRlLCBsYXRpdHVkZSwgbWVzID0gbW9udGgodGltZSkpICU+JSAKICBtdXRhdGUoc3N0X2EgPSBzc3QgLSBtZWFuKHNzdCksIAogICAgICAgICBwcmVzaW9uX2EgPSBwcmVzaW9uIC0gbWVhbihwcmVzaW9uKSkgJT4lIAogIHVuZ3JvdXAoKSAlPiUgCiAgc2VsZWN0KC1tZXMpCmBgYAoKIyMjIHsudW5saXN0ZWQgLnVubnVtYmVyZWR9CgpFbCBOacOxbywgbyBFTlNPIHBvciBFbCBOacOxbyBTb3V0aGVybiBPc2NpbGxhdGlvbiwgZXMgdW5hIGRlIGxvcyBwcmluY2lwYWxlcyBtb2RvcyBkZSB2YXJpYWJpbGlkYWQgZGVsIG9jw6lhbm8uIApTZSB0cmF0YSBkZSB2YXJpYWNpb25lcyBkZSBiYWphIGZyZWN1ZW5jaWEgZW4gbGEgdGVtcGVyYXR1cmEgZGUgbGEgc3VwZXJmaWNpZSBkZWwgbWFyIGVuIGVsIFBhY8OtZmljbyBFY3VhdG9yaWFsLiAKRHVyYW50ZSBsb3MgZXZlbnRvcyBwb3NpdGl2b3MgKEVsIE5pw7FvKSBsYSB0ZW1wZXJhdHVyYSBkZSBsYSBzdXBlcmZpY2llIGRlbCBtYXIgZW4gZWwgbGEgcmVnacOzbiBvcmllbnRhbCBkZWwgUGFjw61maWNvIGVjdWF0b3JpYWwgZXMgbcOhcyBhbHRhIGRlIGxvIG5vcm1hbCwgeSBlbiBsb3MgZXZlbnRvcyBuZWdhdGl2b3MgKExhIE5pw7FhKSwgbGEgdGVtcGVyYXR1cmEgZXMgbcOhcyBmcsOtYSBkZSBsbyBub3JtYWwuIApFc3RhIG9zY2lsYWNpw7NuIHRpZW5lIGltcGFjdG9zIGdsb2JhbGVzLCBhZmVjdGFuZG8gbGEgdGVtcGVyYXR1cmEgeSBsYSBwcmVjaXBpdGFjacOzbiBkZSByZWdpb25lcyBtdXkgYWxlamFkYXMsIGFsZ28gY29ub2NpZG8gY29tbyB0ZWxlY29uZXhpb25lcy4gCgpVbmEgZGUgbGFzIGZvcm1hcyBtw6FzIGNvbXVuZXMgZGUgbWVkaXIgZWwgRU5TTyBlcyBjb24gZWwgw61uZGljZSBvY2XDoW5pY28sIHF1ZSBlcyBsYSBhbm9tYWzDrWEgbWVkaWEgZXN0YW5kYXJpemFkYSBlbiB1bmEgY2FqYSBlbnRyZSAxNzDCukUgeSAxMjDCukUgeSA1wrpTIHkgNcK6TiwgcXVlIHNlIG11ZXN0cmEgZW4gbGEgc2lndWllbnRlIGZpZ3VyYS4gCgpgYGB7cn0KZGF0b3MgJT4lIAogIGZpbHRlcih0aW1lID09IHVuaXF1ZSh0aW1lKVsyMjVdKSAlPiUgCiAgZ2dwbG90KGFlcyhsb25naXR1ZGUsIGxhdGl0dWRlKSkgKwogIGdlb21fY29udG91cl9maWxsKGFlcyh6ID0gc3N0X2EpLCBuYS5maWxsID0gVFJVRSkgKwogIG1hcGEoKSArCiAgYW5ub3RhdGUoInJlY3QiLCB4bWF4ID0gMjQwLCB4bWluID0gMTkwLCB5bWluID0gLTUsIHltYXggPSA1LCBmaWxsID0gTkEsIGNvbG9yID0gImJsYWNrIikgKwogIHNjYWxlX2ZpbGxfZGl2ZXJnZW50KCkKYGBgCgoKRW50b25jZXMsIGFudGVzIHF1ZSBuYWRhIGNhbGN1bGFtb3MgZWwgw61uZGljZSBkZSBFbCBOacOxbyBvY2XDoW5pY28gKE9OSSBwb3IgbGEgc2lnbGFzIGRlIE9jZWFuaWMgTmnDsW8gSW5kZXgpLiAKCiMjIyB7LnRhYnNldCAudW5saXN0ZWQgLnVubnVtYmVyZWR9CgojIyMjIGRhdGEudGFibGUKCmBgYHtyfQplbnNvIDwtIGRhdG9zICU+JSAKICAuW2FicyhsYXRpdHVkZSkgPCA1ICYgQ29udmVydExvbmdpdHVkZShsb25naXR1ZGUpICViZXR3ZWVuJSBjKC0xNzAsIC0xMjApXSAlPiUgCiAgLlssIC4ob25pID0gbWVhbihzc3RfYSkpLCBieSA9IHRpbWVdICU+JSAKICAuWywgb25pIDo9IG9uaS9zZChvbmkpXQpgYGAKCiMjIyMgZHBseXIKCmBgYHtyLCBldmFsID0gRkFMU0V9CmVuc28gPC0gZGF0b3MgJT4lIAogIGZpbHRlcihhYnMobGF0aXR1ZGUpIDwgNSAmIGJldHdlZW4oQ29udmVydExvbmdpdHVkZShsb25naXR1ZGUpLCAtMTcwLCAtMTIwKSkgJT4lIAogIGdyb3VwX2J5KHRpbWUpICU+JSAKICBzdW1tYXJpc2Uob25pID0gbWVhbihzc3RfYSkpICU+JSAKICB1bmdyb3VwKCkgJT4lIAogIG11dGF0ZShvbmkgPSBvbmkvc2Qob25pKSkKYGBgCgojIyMgey50YWJzZXQgLnVubGlzdGVkIC51bm51bWJlcmVkfQoKKFTDqWNuaWNhbWVudGUgZWwgT05JIHRpZW5lIHRhbWJpw6luIHVuIHByb21lZGlvIG3Ds3ZpbCBkZSAzIG1lc2VzLCBwZXJvIG5vIGhhY2UgdGFudGEgZGlmZXJlbmNpYS4pCgrCv0PDs21vIGV2b2x1Y2lvbsOzIGVzdGUgw61uZGljZSBhIGxvIGxhcmdvIGRlbCB0aWVtcG8/IApQb2RlbW9zIGhhY2VyIHVuIGdyw6FmaWNvIGNvbiBlbCDDrW5kaWNlLCBtYXJjYW5kbyBsb3MgdmFsb3JlcyBkZSAkXHBtMC41JCwgcXVlIGRlZmluZW4gbG9zIGV2ZW50b3MgTmnDsW8geSBOacOxYS4KCmBgYHtyfQpnZ3Bsb3QoZW5zbywgYWVzKHRpbWUsIG9uaSkpICsKICBnZW9tX2xpbmUoKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gYygtMC41LCAwLjUpLCBjb2xvciA9ICJncmF5NTAiKSArIAogIGFubm90YXRlKCJsYWJlbCIsIHkgPSBjKDAuNSwgLTAuNSksIHggPSBsdWJyaWRhdGU6OmFzX2RhdGV0aW1lKCIxOTc5LTAxLTAxIiksCiAgICAgICAgICAgbGFiZWwgPSBjKCJOScORTyIsICJOScORQSIpLCB2anVzdCA9IGMoLTAuMiwgMS4yKSwgCiAgICAgICAgICAgbGFiZWwuc2l6ZSA9IGdyaWQ6OnVuaXQoMCwibGluZXMiKSwgY29sb3IgPSAiZ3JheTUwIikgKwogIHNjYWxlX3hfZGF0ZXRpbWUobmFtZSA9IE5VTEwpICsKICBzY2FsZV95X2NvbnRpbnVvdXMobmFtZSA9IE5VTEwpICsKICBsYWJzKHRpdGxlID0gIsONbmRpY2UgRU5TTzM0IiwgCiAgICAgICBjYXB0aW9uID0gIkZ1ZW50ZTogRVJBNSAoMTk3OeKAkzIwMjApIikgKwogIHRoZW1lX21pbmltYWwoKQpgYGAKClNlIHZlbiBjbGFyYW1lbnRlIGFsZ3Vub3MgZXZlbnRvcyBuacOxbyBwYXJ0aWN1bGFybWVudGUgZnVlcnRlcywgY29tbyBlbCBkZSAxOTgzLCAxOTk4IG8gMjAxNSwgYXPDrSBjb21vIGFsZ3Vub3MgZXZlbnRvcyBOacOxYSB0YW1iacOpbiBpbnRlbnNvcywgY29tbyBlbiAxOTg5LiAKCkFob3JhIHBvZGVtb3MgY2FsY3VsYXIgbG9zIGNhbXBvcyBkZSByZWdyZXNpw7NuIGVudHJlIGVzdGUgw61uZGljZSB5IG90cmFzIHZhcmlhYmxlcywgcHJlc2nDs24gYSBuaXZlbCBkZWwgbWFyIGVuIGVzdGUgY2Fzby4gClBhcmEgZXNvIGhheSBxdWUgcHJpbWVybyB1bmlyIGxhIHRhYmxhIGBlbnNvYCBhIGxvcyBkYXRvcyB5IGx1ZWdvIGNhbGN1bGFyIGxhIHJlZ3Jlc2nDs24gcGFyYSBjYWRhIHB1bnRvIGRlIGdyaWxsYS4gCgojIyMgey50YWJzZXQgLnVubGlzdGVkIC51bm51bWJlcmVkfQoKIyMjIyBkYXRhLnRhYmxlCgpgYGB7cn0KZW5zb19yZWdyZXNpb24gPC0gZGF0b3MgJT4lIAogIC5bZW5zbywgb24gPSAidGltZSJdICU+JSAKICAuWywgRml0TG0ocHJlc2lvbl9hLCBvbmkpLCBieSA9IC4obG9uZ2l0dWRlLCBsYXRpdHVkZSldICU+JSAKICAuW3Rlcm0gIT0gIihJbnRlcmNlcHQpIl0gCmBgYAoKIyMjIyBkcGx5cgoKYGBge3IsIGV2YWwgPSBGQUxTRX0KZW5zb19yZWdyZXNpb24gPC0gc3N0ICU+JSAKICByaWdodF9qb2luKGVuc28sIGJ5ID0gInRpbWUiKSAlPiUgCiAgZ3JvdXBfYnkobGF0aXR1ZGUsIGxvbmdpdHVkZSkgJT4lIAogIHN1bW1hcmlzZShhcy5kYXRhLmZyYW1lKEZpdExtKHByZXNpb25fYSwgb25pKSkpICU+JSAKICB1bmdyb3VwKCkgJT4lIAogIGZpbHRlcih0ZXJtICE9ICIoSW50ZXJjZXB0KSIpIApgYGAKCiMjIyB7LnRhYnNldCAudW5saXN0ZWQgLnVubnVtYmVyZWR9CgpZIGFob3JhIHF1ZSB0ZW5lbW9zIGVzdG8sIHBvZGVtb3MgZ3JhZmljYXJsby4gCgpgYGB7cn0KZW5zb19yZWdyZXNpb24gJT4lIAogIGdncGxvdChhZXMobG9uZ2l0dWRlLCBsYXRpdHVkZSkpICsKICBnZW9tX2NvbnRvdXJfZmlsbChhZXMoeiA9IGVzdGltYXRlLCBmaWxsID0gLi5sZXZlbC4uKSwgbmEuZmlsbCA9IDAsIAogICAgICAgICAgICAgICAgICAgIGJyZWFrcyA9IEFuY2hvckJyZWFrcyhiaW53aWR0aCA9IDI1LCBleGNsdWRlID0gMCkpICsKICBnZW9tX2NvbnRvdXJfdGFuYWthKGFlcyh6ID0gZXN0aW1hdGUpLCBuYS5maWxsID0gMCwgCiAgICAgICAgICAgICAgICAgICAgICBicmVha3MgPSBBbmNob3JCcmVha3MoYmlud2lkdGggPSAyNSwgZXhjbHVkZSA9IDApKSArCiAgbWFwYShmaWxsID0gTkEsIGNvbG91ciA9ICJibGFjayIpICArCiAgYW5ub3RhdGUoInJlY3QiLCB4bWF4ID0gMjQwLCB4bWluID0gMTkwLCB5bWluID0gLTUsIHltYXggPSA1LCAKICAgICAgICAgICBmaWxsID0gTkEsIGNvbG9yID0gImJsYWNrIikgKwogIHNjYWxlX2ZpbGxfZGl2ZXJnZW50X2Rpc2NyZXRpc2VkKG5hbWUgPSAiaFBhIikgKwogIHNjYWxlX3hfbG9uZ2l0dWRlKCkgKwogIHNjYWxlX3lfbGF0aXR1ZGUoKSArCiAgY29vcmRfcXVpY2ttYXAoKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICBsYWJzKHRpdGxlID0gIlJlZ3Jlc8Otb24gcHJlc2nDs24gYSBuaXZlbCBkZWwgbWFyIGNvbiBFTlNPIiwgCiAgICAgICBjYXB0aW9uID0gIkZ1ZW50ZTogRVJBNSAoMTk3OeKAkzIwMjApIikKYGBgCgpFbiBlc3RhIGZpZ3VyYSBwb2RlbW9zIHZlciBsYXMgdGVsZWNvbmV4aW9uZXMgZW4gYWNjacOzbi4gTG9zIHZhbG9yZXMgbcOheGltb3MgZGUgcmVncmVzacOzbiBlbnRyZSBsYSB0ZW1wZXJhdHVyYSBkZWwgbWFyIHkgbGEgcHJlc2nDs24gYWwgbml2ZWwgZGVsIG1hciBzZSBkYSBlbiBsYSBjb3N0YSBkZSBsYSBBbnTDoXJ0aWNhIChlbCBtYXIgZGUgQW11bmRzZW4pIGUgZWwgaGVtaXNmZXJpbyBzdXIgeSBlbiBsYSByZWdpw7NuIGRlIGxhcyBBbGV1dGlhbmFzIGVuIGVsIGhlbWlzZmVyaW8gbm9ydGUuIAo=</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("ejemplo.Rmd");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
